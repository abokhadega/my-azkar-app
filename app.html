<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <!-- ربط المانيفيست -->
    <link rel="manifest" href="manifest.json">
    <!-- لون شريط الحالة -->
    <meta name="theme-color" content="#007bff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>تطبيق أذكار (PWA Test)</title>
    <style>
        /* ... كل الـ CSS من النسخة v6.2 ... */
        :root { /* Light */ --bg-color: #f0f0f0; --card-bg-color: #ffffff; --text-color: #333333; --primary-color: #007bff; --primary-text-color: #ffffff; --secondary-text-color: #555555; --fadl-text-color: #28a745; --border-color: #dddddd; --header-footer-bg: #f8f9fa; --active-nav-bg: #e9ecef; --counter-bg-color: #e6e6e6; --theme-icon-next: '🌙'; }
        body.dark-mode { /* Dark */ --bg-color: #1a1a1a; --card-bg-color: #2c2c2c; --text-color: #e0e0e0; --primary-color: #0d6efd; --primary-text-color: #ffffff; --secondary-text-color: #aaaaaa; --fadl-text-color: #34c759; --border-color: #444444; --header-footer-bg: #212529; --active-nav-bg: #343a40; --counter-bg-color: #3a3a3a; --theme-icon-next: '📜'; }
        body.sepia-mode { /* Sepia */ --bg-color: #f4ecd8; --card-bg-color: #efe4cd; --text-color: #5b4636; --primary-color: #8c5e2a; --primary-text-color: #ffffff; --secondary-text-color: #7a6248; --fadl-text-color: #6a4f3a; --border-color: #d8c8a8; --header-footer-bg: #e9dbc6; --active-nav-bg: #d9c8b0; --counter-bg-color: #e0d6c1; --theme-icon-next: '☀️'; }
        html { height: 100%; overflow: hidden; }
        body { font-family: 'Tahoma', 'Arial', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding-top: 60px; direction: rtl; transition: background-color 0.3s, color 0.3s; height: 100vh; display: flex; flex-direction: column; box-sizing: border-box; overflow: hidden; }
        header { position: fixed; top: 0; left: 0; right: 0; height: 60px; background-color: var(--header-footer-bg); border-bottom: 1px solid var(--border-color); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; z-index: 1000; transition: background-color 0.3s, border-color 0.3s; flex-shrink: 0; }
        header .header-btn { background: none; border: none; color: var(--primary-color); font-size: 1.5em; cursor: pointer; padding: 5px 10px; min-width: 40px; text-align: center; transition: color 0.3s; } header .back-btn { visibility: hidden; } header .page-title { font-size: 1.2em; font-weight: bold; text-align: center; flex-grow: 1; margin: 0 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } header .theme-btn { font-size: 1.3em; } header .theme-btn::before { content: var(--theme-icon-next); }
        main { /* Height controlled by JS */ overflow-y: auto; overflow-x: hidden; padding: 15px; flex-grow: 1; display: flex; flex-direction: column; box-sizing: border-box; transition: height 0.3s ease; }
        .page { display: none; animation: fadeIn 0.3s ease-in-out; width: 100%; flex-grow: 1; flex-direction: column; } .page.active { display: flex; } .page.zikr-page-container.active { overflow: hidden; } @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        footer { position: fixed; bottom: 0; left: 0; right: 0; height: 60px; background-color: var(--header-footer-bg); border-top: 1px solid var(--border-color); display: flex; justify-content: space-around; align-items: center; z-index: 1000; transition: background-color 0.3s, border-color 0.3s, transform 0.3s ease-in-out; flex-shrink: 0; } footer.hidden { transform: translateY(100%); } footer button.nav-btn { background: none; border: none; color: var(--secondary-text-color); font-size: 0.8em; font-family: inherit; text-align: center; padding: 5px; flex-grow: 1; border-radius: 5px; cursor: pointer; transition: background-color 0.2s, color 0.2s; display: flex; flex-direction: column; align-items: center; gap: 2px; } footer button.nav-btn span.nav-icon { font-size: 1.4em; } footer button.nav-btn.active { background-color: var(--active-nav-bg); color: var(--primary-color); font-weight: bold; } footer button.nav-btn:hover { background-color: var(--active-nav-bg); }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin-top: 20px; } button.grid-item { background-color: var(--card-bg-color); color: var(--text-color); font-family: inherit; width: 100%; padding: 20px 15px; border-radius: 8px; text-align: center; font-size: 1.1em; font-weight: bold; border: 1px solid var(--border-color); box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.3s, color 0.3s, border-color 0.3s; display: flex; flex-direction: column; align-items: center; gap: 8px; } button.grid-item span.grid-icon { font-size: 1.8em; } button.grid-item:hover { transform: translateY(-3px); box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); }
        .coming-soon { text-align: center; font-size: 1.5em; color: var(--secondary-text-color); margin-top: 50px; padding: 20px; flex-grow: 1; display: flex; align-items: center; justify-content: center; } h2 { text-align: center; color: var(--secondary-text-color); margin-bottom: 25px; }
        .zikr-page-container { padding: 0 !important; height: 100%; }
        .zikr-display-area { background-color: var(--card-bg-color); padding: 0; padding-bottom: calc(35px + env(safe-area-inset-bottom, 0px)); margin: 0; border-radius: 0; border: none; box-shadow: none; cursor: pointer; text-align: center; -webkit-tap-highlight-color: transparent; outline: none; transition: background-color 0.3s; user-select: none; -webkit-user-select: none; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; height: 100%; overflow: hidden; box-sizing: border-box; /* مهم */ }
        .zikr-content { padding: 20px 20px 10px 20px; overflow-y: auto; flex-grow: 1; display: flex; align-items: flex-start; justify-content: center; } .zikr-text { font-size: 1.6em; line-height: 1.8; color: var(--text-color); transition: color 0.3s; text-align: right; width: 100%; }
        .zikr-extra-info { padding: 5px 20px 10px 20px; overflow-y: auto; max-height: 100px; font-size: 0.9em; line-height: 1.6; color: var(--fadl-text-color); text-align: right; border-top: 1px dashed var(--border-color); flex-shrink: 0; transition: color 0.3s, border-color 0.3s; } .zikr-extra-info p { margin: 5px 0; } .zikr-extra-info strong { color: var(--secondary-text-color); margin-left: 5px; transition: color 0.3s; } .zikr-extra-info:empty { display: none; }
        .zikr-controls { display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border-top: 1px solid var(--border-color); background-color: var(--header-footer-bg); transition: background-color 0.3s, border-color 0.3s; flex-shrink: 0; } .zikr-total-count { font-size: 0.9em; color: var(--secondary-text-color); font-weight: bold; text-align: right; min-width: 60px; transition: color 0.3s; } .share-btn { background: none; border: none; color: var(--primary-color); font-size: 1.6em; cursor: pointer; padding: 5px; line-height: 1; min-width: 40px; transition: color 0.3s; } .share-btn:hover { opacity: 0.7; }
        .circular-counter-container { position: relative; width: 55px; height: 55px; } .circular-counter-svg { width: 100%; height: 100%; transform: rotate(-90deg); } .counter-bg { fill: none; stroke: var(--counter-bg-color); stroke-width: 4; transition: stroke 0.3s; } .counter-progress { fill: none; stroke: var(--primary-color); stroke-width: 4.5; stroke-linecap: round; transition: stroke-dasharray 0.3s ease, stroke 0.3s; } .counter-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 1.1em; font-weight: bold; color: var(--text-color); transition: color 0.3s; }
        .zikr-completed-container { flex-grow: 1; display: flex; align-items: center; justify-content: center; padding: 20px; padding-bottom: calc(35px + env(safe-area-inset-bottom, 0px)); background-color: var(--card-bg-color); height: 100%; box-sizing: border-box; }
        .zikr-completed { font-size: 1.5em; color: var(--secondary-text-color); font-weight: bold; text-align: center; transition: color 0.3s; }
    </style>
</head>
<body>
    <header> <!-- ... --> <button class="header-btn back-btn" id="back-btn">←</button> <h1 class="page-title" id="page-title-display">الرئيسية</h1> <button class="header-btn theme-btn" id="theme-toggle-btn"></button> </header>
    <main> <!-- ... --> <div id="page-home" class="page active"> <h2>الأقسام الرئيسية</h2> <div class="grid-container"> <button class="grid-item" data-page="quran"> <span class="grid-icon">📖</span> <span>القرآن الكريم</span> </button> <button class="grid-item" data-page="azkar-main"> <span class="grid-icon">📿</span> <span>الأذكار</span> </button> <button class="grid-item" data-page="salah"> <span class="grid-icon">🕌</span> <span>الصلاة</span> </button> <button class="grid-item" data-page="settings"> <span class="grid-icon">⚙️</span> <span>الإعدادات</span> </button> </div> </div> <div id="page-quran" class="page"> <div class="coming-soon"> 📖 قريباً إن شاء الله... </div> </div> <div id="page-azkar-main" class="page"> <h2>أقسام الأذكار</h2> <div class="grid-container"> <button class="grid-item" data-page="azkar-sabah"> <span class="grid-icon">☀️</span> <span>أذكار الصباح</span> </button> <button class="grid-item" data-page="azkar-masaa"> <span class="grid-icon">🌙</span> <span>أذكار المساء</span> </button> <button class="grid-item" data-page="azkar-salah"> <span class="grid-icon">🛐</span> <span>أذكار بعد الصلاة</span> </button> <button class="grid-item" data-page="azkar-misc"> <span class="grid-icon">✨</span> <span>أذكار متنوعة</span> </button> </div> </div> <div id="page-azkar-sabah" class="page"></div> <div id="page-azkar-masaa" class="page"></div> <div id="page-azkar-salah" class="page"></div> <div id="page-azkar-misc" class="page"></div> <div id="page-salah" class="page"> <div class="coming-soon"> 🕌 قريباً إن شاء الله... </div> </div> <div id="page-settings" class="page"> <div class="coming-soon"> ⚙️ قريباً إن شاء الله... </div> </div> </main>
    <footer id="app-footer"> <!-- ... --> <button class="nav-btn" data-page="home"> <span class="nav-icon">🏠</span> <span>الرئيسية</span> </button> <button class="nav-btn" data-page="quran"> <span class="nav-icon">📖</span> <span>القرآن</span> </button> <button class="nav-btn" data-page="azkar-main"> <span class="nav-icon">📿</span> <span>الأذكار</span> </button> <button class="nav-btn" data-page="salah"> <span class="nav-icon">🕌</span> <span>الصلاة</span> </button> <button class="nav-btn" data-page="settings"> <span class="nav-icon">⚙️</span> <span>الإعدادات</span> </button> </footer>
    <script>
        /* ... كل الـ JavaScript من النسخة v6 ... */
        const themeToggleButton = document.getElementById('theme-toggle-btn'); const backButton = document.getElementById('back-btn'); const pageTitleDisplay = document.getElementById('page-title-display'); const pages = document.querySelectorAll('.page'); const navButtons = document.querySelectorAll('footer .nav-btn'); const gridButtons = document.querySelectorAll('.grid-item'); const mainElement = document.querySelector('main'); const footerElement = document.getElementById('app-footer'); const azkarData = { sabah: [ { text: "أَصْبَحْنَا وَأَصْبَحَ الْمُلْكُ لِلَّهِ...", count: 1, fadl: "من قاله حين يصبح أجير من الشيطان حتى يمسي.", sanad: "صحيح مسلم" }, { text: "اللَّهُمَّ بِكَ أَصْبَحْنَا...", count: 1, fadl: "", sanad: "سنن الترمذي (حسن)" }, { text: "سَيِّدُ الاِسْتِغْفَارِ...", count: 1, fadl: "من قاله موقناً به حين يمسي فمات من ليلته دخل الجنة، وكذلك إذا أصبح.", sanad: "صحيح البخاري" }, { text: "اللَّهُمَّ عَافِنِي فِي بَدَنِي...", count: 3, fadl: "", sanad: "سنن أبي داود (حسن)" }, { text: "سُبْحَانَ اللَّهِ وَبِحَمْدِهِ", count: 100, fadl: "لم يأت أحد يوم القيامة بأفضل مما جاء به إلا أحد قال مثل ما قال أو زاد عليه.", sanad: "صحيح مسلم" }, { text: "لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ...", count: 10, fadl: "كانت له عدل عشر رقاب، وكتبت له مئة حسنة، ومحيت عنه مئة سيئة، وكانت له حرزاً من الشيطان.", sanad: "متفق عليه" }, { text: "أَعُوذُ بِكَلِمَاتِ اللَّهِ التَّامَّاتِ مِنْ شَرِّ مَا خَلَقَ.", count: 3, fadl: "من قالها حين يمسي لم يضره شيء.", sanad: "صحيح مسلم" } ], masaa: [ { text: "أَمْسَيْنَا وَأَمْسَى الْمُلْكُ لِلَّهِ...", count: 1, fadl: "من قاله حين يمسي أجير من الشيطان حتى يصبح.", sanad: "صحيح مسلم" }, { text: "اللَّهُمَّ بِكَ أَمْسَيْنَا...", count: 1, fadl: "", sanad: "سنن الترمذي (حسن)" }, { text: "آيَةُ الْكُرْسِيِّ...", count: 1, fadl: "من قرأها حين يمسي أجير من الجن حتى يصبح.", sanad: "صحيح الترغيب والترهيب" }, { text: "قُلْ هُوَ اللَّهُ أَحَدٌ والمعوذتين", count: 3, fadl: "تكفيه من كل شيء.", sanad: "سنن أبي داود والترمذي (حسن صحيح)" }, { text: "سُبْحَانَ اللَّهِ وَبِحَمْدِهِ", count: 100, fadl: "حُطَّتْ خطاياه وإن كانت مثل زبد البحر.", sanad: "متفق عليه (لفظ مسلم)" }, { text: "أَعُوذُ بِكَلِمَاتِ اللَّهِ التَّامَّاتِ مِنْ شَرِّ مَا خَلَقَ.", count: 3, fadl: "لم يضره شيء.", sanad: "صحيح مسلم" } ], salah: [ { text: "أَسْتَغْفِرُ اللَّهَ", count: 3, fadl: "", sanad:"صحيح مسلم" }, { text: "اللَّهُمَّ أَنْتَ السَّلاَمُ...", count: 1, fadl: "", sanad:"صحيح مسلم" }, { text: "لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ...", count: 1, fadl: "", sanad:"صحيح البخاري" }, { text: "سُبْحَانَ اللَّهِ", count: 33, fadl: "من سبح الله في دبر كل صلاة ثلاثاً وثلاثين...", sanad:"صحيح مسلم" }, { text: "الْحَمْدُ لِلَّهِ", count: 33, fadl: "... وحمد الله ثلاثاً وثلاثين...", sanad:"صحيح مسلم" }, { text: "اللَّهُ أَكْبَرُ", count: 33, fadl: "... وكبر الله ثلاثاً وثلاثين...", sanad:"صحيح مسلم" }, { text: "لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ... (تمام المائة)", count: 1, fadl: "... غفرت خطاياه وإن كانت مثل زبد البحر.", sanad:"صحيح مسلم" }, { text: "آيَةُ الْكُرْسِيِّ", count: 1, fadl: "من قرأها دبر كل صلاة مكتوبة لم يمنعه من دخول الجنة إلا أن يموت.", sanad:"صحيح النسائي وصححه الألباني" }, { text: "قُلْ هُوَ اللَّهُ أَحَدٌ", count: 1, fadl:"المعوذات تقرأ بعد كل صلاة", sanad:"سنن أبي داود (صحيح)" }, { text: "قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ", count: 1, fadl:"", sanad:"سنن أبي داود (صحيح)" }, { text: "قُلْ أَعُوذُ بِرَبِّ النَّاسِ", count: 1, fadl:"", sanad:"سنن أبي داود (صحيح)" } ], misc: [ { text: "سبحان الله وبحمده، سبحان الله العظيم", count: 10, fadl:"كلمتان خفيفتان على اللسان، ثقيلتان في الميزان، حبيبتان إلى الرحمن.", sanad:"متفق عليه" }, { text: "لا حول ولا قوة إلا بالله", count: 10, fadl:"كنز من كنوز الجنة.", sanad:"متفق عليه" }, { text: "اللهم صلِّ وسلِّم على نبينا محمد", count: 10, fadl:"من صلى علي صلاة صلى الله عليه بها عشراً.", sanad:"صحيح مسلم" }, { text: "أستغفر الله الذي لا إله إلا هو الحي القيوم وأتوب إليه", count: 10, fadl:"غفر له وإن كان فر من الزحف.", sanad:"سنن أبي داود والترمذي (صحيح)" } ] };
        let currentZikrStates = {}; let currentPageId = 'home';
        function initializeAzkarPage(azkarType, pageElementId, completedMessage) { const pageElement = document.getElementById(pageElementId); if (!pageElement) return; pageElement.classList.add('zikr-page-container'); const azkarList = azkarData[azkarType] || []; pageElement.innerHTML = ''; if (azkarList.length === 0) { pageElement.innerHTML = `<div class="zikr-completed-container"><div class="zikr-completed">لا توجد أذكار لعرضها.</div></div>`; return; } if (!currentZikrStates[azkarType] || currentZikrStates[azkarType].index >= azkarList.length) { currentZikrStates[azkarType] = { index: 0, count: azkarList[0].count, originalCount: azkarList[0].count }; } let state = currentZikrStates[azkarType]; const displayArea = document.createElement('div'); displayArea.className = 'zikr-display-area'; const zikrContent = document.createElement('div'); zikrContent.className = 'zikr-content'; const zikrTextElement = document.createElement('div'); zikrTextElement.className = 'zikr-text'; zikrContent.appendChild(zikrTextElement); const zikrExtraInfo = document.createElement('div'); zikrExtraInfo.className = 'zikr-extra-info'; const zikrControls = document.createElement('div'); zikrControls.className = 'zikr-controls'; const shareButton = document.createElement('button'); shareButton.className = 'share-btn'; shareButton.innerHTML = '🔗'; const counterContainer = document.createElement('div'); counterContainer.className = 'circular-counter-container'; counterContainer.innerHTML = `<svg class="circular-counter-svg" viewBox="0 0 36 36"> <path class="counter-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/> <path class="counter-progress" stroke-dasharray="100, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/> </svg> <div class="counter-text">0</div>`; const counterProgress = counterContainer.querySelector('.counter-progress'); const counterText = counterContainer.querySelector('.counter-text'); const totalCountElement = document.createElement('div'); totalCountElement.className = 'zikr-total-count'; shareButton.onclick = (event) => { event.stopPropagation(); shareZikr(azkarList[state.index]?.text); }; zikrControls.appendChild(shareButton); zikrControls.appendChild(counterContainer); zikrControls.appendChild(totalCountElement); displayArea.appendChild(zikrContent); displayArea.appendChild(zikrExtraInfo); displayArea.appendChild(zikrControls); pageElement.appendChild(displayArea); function displayCurrentZikrUI() { if (state.index >= azkarList.length) { pageElement.innerHTML = `<div class="zikr-completed-container"><div class="zikr-completed">${completedMessage}</div></div>`; return; } const zikr = azkarList[state.index]; state.originalCount = zikr.count; zikrTextElement.textContent = zikr.text; let extraInfoHTML = ''; if (zikr.fadl && zikr.fadl.trim() !== '') { extraInfoHTML += `<p><strong>الفضل:</strong> ${zikr.fadl}</p>`; } if (zikr.sanad && zikr.sanad.trim() !== '') { extraInfoHTML += `<p><strong>المصدر:</strong> ${zikr.sanad}</p>`; } zikrExtraInfo.innerHTML = extraInfoHTML; zikrExtraInfo.style.display = extraInfoHTML === '' ? 'none' : 'block'; totalCountElement.textContent = `العدد: ${state.originalCount}`; counterText.textContent = state.count; const progress = state.originalCount > 0 ? Math.max(0, Math.min(100, (state.count / state.originalCount) * 100)) : 0; counterProgress.style.strokeDasharray = `${progress}, 100`; } function goToPrevZikr() { if (azkarList.length <= 1) return; state.index--; if (state.index < 0) { state.index = azkarList.length - 1; } state.count = azkarList[state.index].count; state.originalCount = azkarList[state.index].count; displayCurrentZikrUI(); } function goToNextZikr() { if (azkarList.length <= 1) return; state.index++; if (state.index >= azkarList.length) { state.index = 0; } state.count = azkarList[state.index].count; state.originalCount = azkarList[state.index].count; displayCurrentZikrUI(); } displayArea.onclick = () => { if (state.index >= azkarList.length) return; state.count--; if (state.count < 0) state.count = 0; counterText.textContent = state.count; const progress = state.originalCount > 0 ? Math.max(0, Math.min(100, (state.count / state.originalCount) * 100)) : 0; counterProgress.style.strokeDasharray = `${progress}, 100`; if (state.count <= 0) { setTimeout(() => { state.index++; if (state.index < azkarList.length) { state.count = azkarList[state.index].count; state.originalCount = azkarList[state.index].count; displayCurrentZikrUI(); } else { pageElement.innerHTML = `<div class="zikr-completed-container"><div class="zikr-completed">${completedMessage}</div></div>`; } }, 250); } }; let touchStartX = 0; let touchStartY = 0; let touchStartTime = 0; const swipeThreshold = 50; const swipeMaxPerpendicular = 75; const swipeMaxTime = 500; displayArea.addEventListener('touchstart', (e) => { if (state.index >= azkarList.length) return; const touch = e.changedTouches[0]; touchStartX = touch.screenX; touchStartY = touch.screenY; touchStartTime = new Date().getTime(); }, { passive: true }); displayArea.addEventListener('touchend', (e) => { if (state.index >= azkarList.length || touchStartX === 0) return; const touch = e.changedTouches[0]; const touchEndX = touch.screenX; const touchEndY = touch.screenY; const touchEndTime = new Date().getTime(); const deltaX = touchEndX - touchStartX; const deltaY = touchEndY - touchStartY; const elapsedTime = touchEndTime - touchStartTime; if (elapsedTime <= swipeMaxTime && Math.abs(deltaY) <= swipeMaxPerpendicular) { if (deltaX > swipeThreshold) { goToPrevZikr(); } else if (deltaX < -swipeThreshold) { goToNextZikr(); } } touchStartX = 0; touchStartY = 0; touchStartTime = 0; }, { passive: true }); displayCurrentZikrUI(); }
        function shareZikr(text) { if (!text) return; if (navigator.share) { navigator.share({ title: 'ذكر من تطبيق الأذكار', text: text, }).then(() => console.log('Successful share')).catch((error) => console.log('Error sharing', error)); } else { try { navigator.clipboard.writeText(text); alert('تم نسخ الذكر إلى الحافظة!'); } catch (err) { alert('المشاركة غير مدعومة.'); console.error('Fallback share failed:', err); } } }
        function navigateTo(pageId) { const previousPage = document.getElementById(`page-${currentPageId}`); if (previousPage) previousPage.classList.remove('active', 'zikr-page-container'); currentPageId = pageId; const targetPage = document.getElementById(`page-${pageId}`); if (!targetPage) { console.error(`Page with ID 'page-${pageId}' not found.`); navigateTo('home'); return; } targetPage.classList.add('active'); const isAzkarSubPage = pageId.startsWith('azkar-') && pageId !== 'azkar-main'; if (isAzkarSubPage) { targetPage.classList.add('zikr-page-container'); mainElement.style.padding = '0'; footerElement.classList.add('hidden'); footerElement.style.display = 'none'; mainElement.style.height = 'calc(100vh - 60px)'; } else { mainElement.style.padding = '15px'; footerElement.classList.remove('hidden'); footerElement.style.display = 'flex'; mainElement.style.height = 'calc(100vh - 120px)'; } let title = "تطبيق الأذكار"; const navButton = footerElement.querySelector(`button[data-page="${pageId}"]`); const gridButton = document.querySelector(`.grid-item[data-page="${pageId}"]`); if (gridButton) { title = gridButton.querySelector('span:last-child')?.textContent || title; } else if (navButton) { title = navButton.querySelector('span:last-child')?.textContent || title; } if(pageId === 'azkar-main') title = "الأذكار"; pageTitleDisplay.textContent = title; backButton.style.visibility = (pageId === 'home') ? 'hidden' : 'visible'; navButtons.forEach(btn => { const btnPage = btn.dataset.page; let mainSection = pageId; if (pageId.startsWith('azkar-') && pageId !== 'azkar-main') { mainSection = 'azkar-main'; } btn.classList.toggle('active', btnPage === mainSection); }); if (isAzkarSubPage) { if (pageId === 'azkar-sabah') initializeAzkarPage('sabah', `page-${pageId}`, "أكملت أذكار الصباح!"); else if (pageId === 'azkar-masaa') initializeAzkarPage('masaa', `page-${pageId}`, "أكملت أذكار المساء!"); else if (pageId === 'azkar-salah') initializeAzkarPage('salah', `page-${pageId}`, "أكملت أذكار بعد الصلاة!"); else if (pageId === 'azkar-misc') initializeAzkarPage('misc', `page-${pageId}`, "أكملت الأذكار المتنوعة!"); } }
        function applyTheme(theme) { document.body.classList.remove('dark-mode', 'sepia-mode'); document.documentElement.style.setProperty('--theme-icon-next', "'🌙'"); if (theme === 'dark') { document.body.classList.add('dark-mode'); document.documentElement.style.setProperty('--theme-icon-next', "'📜'"); } else if (theme === 'sepia') { document.body.classList.add('sepia-mode'); document.documentElement.style.setProperty('--theme-icon-next', "'☀️'"); } }
        themeToggleButton.addEventListener('click', () => { let currentTheme = 'light'; if (document.body.classList.contains('dark-mode')) { currentTheme = 'dark'; } else if (document.body.classList.contains('sepia-mode')) { currentTheme = 'sepia'; } let newTheme; if (currentTheme === 'light') { newTheme = 'dark'; } else if (currentTheme === 'dark') { newTheme = 'sepia'; } else { newTheme = 'light'; } localStorage.setItem('theme', newTheme); applyTheme(newTheme); });
        navButtons.forEach(button => button.addEventListener('click', () => navigateTo(button.dataset.page))); gridButtons.forEach(button => button.addEventListener('click', () => navigateTo(button.dataset.page))); backButton.addEventListener('click', () => { if (currentPageId.startsWith('azkar-') && currentPageId !== 'azkar-main') { navigateTo('azkar-main'); } else { navigateTo('home'); } });
        const savedTheme = localStorage.getItem('theme') || 'light'; const validThemes = ['light', 'dark', 'sepia']; const initialTheme = validThemes.includes(savedTheme) ? savedTheme : 'light'; applyTheme(initialTheme); navigateTo('home');
    </script>
    <!-- كود تسجيل الـ Service Worker هنا -->
    <script> if ('serviceWorker' in navigator) { window.addEventListener('load', () => { navigator.serviceWorker.register('./sw.js').then(registration => { console.log('SW registered: ', registration.scope); }).catch(error => { console.log('SW registration failed: ', error); }); }); } </script>
</body>
</html>